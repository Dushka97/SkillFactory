# Проект 5. Прогнозирование времени поездки такси в городе New York (Machine Learning regression)

## Оглавление
[1. Описание проекта](/README_ML_regression.md#Описание-проекта)

[2. Какой кейс решаем?](/README_ML_regression.md#Какой-кейс-решаем?)

[3. Краткая информация о данных](README_ML_regression.md#Краткая-информация-о-данных)

[4. Этапы работы над проетом](/README_ML_regression.md#Этапы-работы-над-проектом)

[5. Результат](/README_ML_regression.md#Результат)

[6. Выводы](/README_ML_regression.md#Выводы)

### Описание проета
Предстоит решить задачу машинного обучения, направленную на автоматизацию бизнес процессов. Мы построим модель, которая будет предсказывать общую продолжительность поездки такси в Нью-Йорке. 

:arrow_up: [к оглавлению](https://github.com/Dushka97/sf_data_science/tree/main/project_3/README_ML_regression.md#Оглавление)

### Какой кейс решаем?

Построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак - время поездки такси.

**Бизнес-задача:**
Определяем характеристики и с их помощью прогнозировать длительность поездки такси.

### Краткая информация о данных

*Данные о клиенте и таксопарке:*
- id - уникальный идентификатор поездки
- vendor_id - уникальный идентификатор поставщика (таксопарка), связанного с записью поездки

*Временные характеристики:*
* pickup_datetime - дата и время, когда был включен счетчик поездки
* dropoff_datetime - дата и время, когда счетчик был отключен

*Географическая информация:*
* pickup_longitude -  долгота, на которой был включен счетчик
* pickup_latitude - широта, на которой был включен счетчик
* dropoff_longitude - долгота, на которой счетчик был отключен
* dropoff_latitude - широта, на которой счетчик был отключен

*Прочие признаки:*
* passenger_count - количество пассажиров в транспортном средстве (введенное водителем значение)
* store_and_fwd_flag - флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику. Y - хранить и пересылать, N - не хранить и не пересылать поездку.

*Целевой признак:*
- trip_duration - продолжительность поездки в секундах

**Метрика качества**

"Root mean square log error" на тестовой выборке.

**Что практикуем?**

Строим модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать стоимость поездки на такси в городе Нью Йорк.

### Этапы работы над проектом

1) Первичная обработка данных. В рамках этой части предстоит обработать пропуски и выбросы в данных.

2) Разведывательный анализ данных (EDA). Необходимо исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.

3) Отбор и преобразование признаков. На этом этапе перекодируем и преобразуем данные таким образом, чтобы их можно было использовать при решении задачи регрессии.

4) Решение задачи регрессии. На данном этапе строим прогностические модели на основе:

- LineraRegression;
- DecisionTreeRegressor;
- RandomForestRegressor;
- GradientBoostingRegressor;
- XGBoost.

Оцениваем качество построенных моделей.


### Результат

С помощью XGBoost построена прошностическая модель с наилучшим значением метрики качества RMSLE - 0.392, что дает ошибку при расчете медианной длительности поездки в 1.8 минуты. Отобраны наиболее значмые признаки (imp_feature) в решении задачи регрессии. 

### Выводы

В ТОП-10 признаков влияющих на длительность поездки входят:
- Время подачи машины;
- Географическая широта окончания поездки;
- Расстояние Хаверсина;
- Географическая широта начала поездки;
- Географическая долготова начала поездки;
- Географическая долгота окончания поездки;
- Общая дистанция поездки;
- Общая длительность поездки;
- Температура окружающей среды;
- Число шагов от начала до завершения поездки.



:arrow_up: [к оглавлению](https://github.com/Dushka97/sf_data_science/tree/main/project_3/README_ML_regression.md#Оглавление)