# Проект 4. Прогнозирование открытие депозита клиентами банка (Machine Learning classification)

## Оглавление
[1. Описание проекта](/README_ML4md#Описание-проекта)

[2. Какой кейс решаем?](/README_ML4md#Какой-кейс-решаем?)

[3. Краткая информация о данных](README_ML4md#Краткая-информация-о-данных)

[4. Этапы работы над проетом](/README_ML4md#Этапы-работы-над-проектом)

[5. Результат](/README_ML4md#Результат)

[6. Выводы](/README_ML4md#Выводы)

### Описание проета
Имеются данные о последней маркетинговой кампании, которую проводил банк: задачей было привлечь клиентов для открытия депозита. Я должен проанализировать эти данные, выявить закономерность и найти решающие факторы, повлиявшие на то, что клиент вложил деньги именно в этот банк.

:arrow_up: [к оглавлению](https://github.com/Dushka97/sf_data_science/tree/main/project_3/README_ML4md#Оглавление)

### Какой кейс решаем?

Прогнозируем открытие депозита клиентами банка с использованием логистической регрессии, случайного леса и градиентного бустинга.

**Бизнес-задача:**
Определить характеристики, по которым можно выявить клиентов, более склонных к открытию депозита в банке, и за счёт этого повысить результативность маркетинговой кампании.

### Краткая информация о данных

*Данные о клиентах банка:*

- age (возраст);
- job (сфера занятости);
- marital (семейное положение);
- education (уровень образования);
- default (имеется ли просроченный кредит);
- housing (имеется ли кредит на жильё);
- loan (имеется ли кредит на личные нужды);
- balance (баланс).

*Данные, связанные с последним контактом в контексте текущей маркетинговой кампании:*

- contact (тип контакта с клиентом);
- month (месяц, в котором был последний контакт);
- day (день, в который был последний контакт);
- duration (продолжительность контакта в секундах).

*Прочие признаки:*

- campaign (количество контактов с этим клиентом в течение текущей кампании);
- pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
- previous (количество контактов до текущей кампании)
- poutcome (результат прошлой маркетинговой кампании).

И, разумеется, наша целевая переменная **deposit**, которая определяет, согласится ли клиент открыть депозит в банке. Именно её мы будем пытаться предсказать в данном кейсе.

**Метрика качества**

"F1-score" на тестовой выборке.

**Что практикуем?**

Строим модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать, воспользуется он предложением об открытии депозита или нет.


### Этапы работы над проектом

1) Первичная обработка данных. В рамках этой части предстоит обработать пропуски и выбросы в данных.

2) Разведывательный анализ данных (EDA). Необходимо исследовать данные, нащупать первые закономерности и выдвинуть гипотезы.

3) Отбор и преобразование признаков. На этом этапе перекодируем и преобразуем данные таким образом, чтобы их можно было использовать при решении задачи классификации.

4) Решение задачи классификации: логистическая регрессия и решающие деревья. На данном этапе строим прогностическую модель и оцениваем её качество.

5) Решение задачи классификации: ансамбли моделей и построение прогноза. На заключительном этапе дорабатываем предсказание с использованием более сложных алгоритмов и оцениваем, с помощью какой модели возможно сделать более качественные прогнозы.


### Результат

С помощью продвинутого метода оптимизации гиперпараметров "OPTUNA" подобраны оптимальные значения для случайного леса и решена задачи прогнозирования открытия депозита в банке. 

**Оптимальные значения гиперпараметров:**
Число деревьев (n_estimators) в RandomForest равно 124; 
Максимальная глубина деревьев (max_depth) равна 28;
Минимальное число листьев (min_samples_leaf) равно 5.

Значение метрики **F1** составляет 0.82

### Выводы

На основании данных собранных в результате проведенной маркетинговой компании удалось построить ML-модель на основе случайного леса (RandomForest) для прогнозирования открытия депозита.

***Наиболее значимыми признаками оказались:***

- age_group (возрастная группа);
- housing (имеется ли кредит на жильё);
- balance (баланс);
- contact_cellular (тип контакта с клиентом по телефону);
- month (месяц, в котором был последний контакт), а именно: май, март, октябрь, сентябрь;
- duration (продолжительность контакта в секундах).
- pdays (количество пропущенных дней с момента последней маркетинговой кампании до контакта в текущей кампании);
- previous (количество контактов до текущей кампании)
- poutcome (результат прошлой маркетинговой кампании).


:arrow_up: [к оглавлению](https://github.com/Dushka97/sf_data_science/tree/main/project_3/README_ML4md#Оглавление)